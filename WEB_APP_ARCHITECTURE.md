# Описание архитектуры веб-приложения для генерации схемы

## Общее описание
Веб-приложение на Flutter для просмотра и настройки дизайн-токенов и компонентов. Приложение поддерживает светлую и темную темы, имеет современный интерфейс в стиле Yellowbe от Beeline.

## Структура приложения

### 1. Точка входа (main_web.dart)
- **Расположение**: `lib/main_web.dart`
- **Роль**: Точка входа веб-приложения
- **Ключевые компоненты**:
  - `WebApp` - главный виджет приложения
  - `AppThemeProvider` - провайдер темы (светлая/темная)
  - `MaterialApp` - обертка приложения с настройкой темы
  - Использует Google Fonts (Roboto) для веба
- **Связи**: 
  - → `AppWeb` (главный экран)
  - → `AppThemeProvider` (управление темой)

### 2. Главный экран (app_web.dart)
- **Расположение**: `lib/ui_web/app_web.dart`
- **Роль**: Основной layout приложения с навигацией
- **Структура**:
  - **Боковая панель навигации** (280px):
    - Логотип с градиентом (фиолетовый квадрат с иконкой палитры)
    - Навигационные элементы:
      - "Дизайн-токены" (TokensPage)
      - "Компоненты" (ComponentsPage)
    - Переключатель темы внизу
  - **Основной контент** (расширяемый):
    - Использует `IndexedStack` для переключения страниц
    - `FadeTransition` для плавных переходов
- **Анимации**:
  - Плавное переключение страниц (FadeTransition)
  - Hover-эффекты на элементах навигации
  - Анимация масштабирования при наведении
- **Связи**:
  - → `TokensPage` (страница токенов)
  - → `ComponentsPage` (страница компонентов)
  - → `AppThemeProvider` (получение темы)

### 3. Страница токенов (tokens_page.dart)
- **Расположение**: `lib/ui_web/pages/tokens_page.dart`
- **Роль**: Отображение дизайн-токенов (цвета, отступы, типографика)
- **Структура**:
  - **Заголовок**: "Дизайн-токены"
  - **Секции**:
    1. **Палитра** (_buildColorsSection):
       - Группы цветов: Black Colors, White Colors, Blue Colors, Red Colors, Orange Colors, Green Colors
       - Каждая группа сворачиваемая/разворачиваемая
    2. **Отступы** (_buildSpacingSection):
       - Визуализация отступов с полосками
    3. **Шрифты** (_buildTypographySection):
       - Font Family, Font Weights, Font Sizes
    4. **Токены** (_buildThemeTokensSection):
       - Text Colors, Border Colors
- **Особенности**:
  - Группы цветов можно сворачивать/разворачивать
  - Анимированное сворачивание (AnimatedSize)
  - Карточки с цветами показывают swatch, название и hex-код
  - В темной теме используется черный текст на белом фоне карточек
- **Связи**:
  - → `AppThemeProvider` (получение токенов темы)
  - → `AppColors`, `AppSpacing`, `AppTypography` (базовые токены)

### 4. Страница компонентов (components_page.dart)
- **Расположение**: `lib/ui_web/pages/components_page.dart`
- **Роль**: Интерактивная настройка компонента UiButton
- **Структура**:
  - **Левая панель** (настройки):
    - Заголовок "UiButton"
    - Поле ввода текста
    - Чекбоксы для иконок (Left Icon, Right Icon)
    - Селекторы:
      - State (defaultState, hover, disabled)
      - Style (main, minor)
      - Type (accent, neutral, success, critical)
      - Size (S, M, L, XL)
      - Role (squircle, rounded)
  - **Правая панель** (предпросмотр):
    - Карточка "Предпросмотр"
    - Мобильный предпросмотр (375x812px)
    - Кнопка UiButton в центре
- **Особенности**:
  - Изменения применяются в реальном времени
  - В темной теме серые фоны для групп контролов
  - Белые галочки чекбоксов в темной теме
- **Связи**:
  - → `UiButton` (компонент кнопки)
  - → `AppThemeProvider` (получение темы)

### 5. Система тем (core/theme/)
- **Расположение**: `lib/core/theme/`
- **Компоненты**:
  - **app_theme.dart**:
    - `AppThemeProvider` - ChangeNotifier для управления темой
    - Методы: `toggleTheme()`, `setLightTheme()`, `setDarkTheme()`
    - Геттеры для всех токенов темы
  - **app_theme_tokens.dart**:
    - `AppThemeLightTokens` - токены светлой темы
    - `AppThemeDarkTokens` - токены темной темы
    - Категории: Border, Text, Icon, Background, Surface
  - **app_colors.dart**:
    - Базовые цвета: White Colors, Black Colors, Blue Colors, Red Colors, Orange Colors, Green Colors
    - Каждый цвет имеет варианты: Main, 100-800, 600
  - **app_spacing.dart**:
    - Отступы: spacing0, spacing4, spacing8, spacing10, spacing12, spacing16, spacing20, spacing24, spacing28, spacing32
    - Множители: spaceX1, spaceX2, spaceX3, spaceX4, spaceX5, spaceX6
  - **app_typography.dart**:
    - Font Family: Roboto (fontSans)
    - Font Weights: Regular (400), Medium (500), Bold (700)
    - Font Sizes: 10px - 32px
  - **app_text_styles_web.dart**:
    - Стили текста для веба с использованием Google Fonts
    - H1, H2, Large, Body (Regular/Medium/Bold/Monospace), Small (Regular/Medium/Monospace)

### 6. Компоненты (ui/widgets/)
- **ui_button.dart**:
  - Универсальный компонент кнопки
  - Параметры: text, leftIcon, rightIcon, state, style, type, size, role
  - Поддержка всех состояний и стилей

## Визуальная схема архитектуры

```
┌─────────────────────────────────────────────────────────────┐
│                    main_web.dart                             │
│  ┌──────────────────────────────────────────────────────┐   │
│  │              WebApp (StatefulWidget)                 │   │
│  │  ┌──────────────────────────────────────────────┐   │   │
│  │  │      AppThemeProvider (ChangeNotifier)        │   │   │
│  │  │  - isDarkMode                                │   │   │
│  │  │  - toggleTheme()                             │   │   │
│  │  │  - getters для всех токенов                  │   │   │
│  │  └──────────────────────────────────────────────┘   │   │
│  │  ┌──────────────────────────────────────────────┐   │   │
│  │  │           MaterialApp                         │   │   │
│  │  │  - Theme configuration                        │   │   │
│  │  │  - Google Fonts (Roboto)                      │   │   │
│  │  └──────────────────────────────────────────────┘   │   │
│  └──────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│                    app_web.dart                              │
│  ┌──────────────────────────────────────────────────────┐   │
│  │              AppWeb (StatefulWidget)                 │   │
│  │  ┌──────────────────┐  ┌──────────────────────────┐ │   │
│  │  │  Боковая панель  │  │   Основной контент       │ │   │
│  │  │  (280px)         │  │   (Expanded)             │ │   │
│  │  │                  │  │                          │ │   │
│  │  │  ┌────────────┐  │  │  ┌────────────────────┐ │ │   │
│  │  │  │  Логотип   │  │  │  │  IndexedStack      │ │ │   │
│  │  │  └────────────┘  │  │  │  ┌──────────────┐ │ │ │   │
│  │  │  ┌────────────┐  │  │  │  │ TokensPage   │ │ │ │   │
│  │  │  │ Навигация  │  │  │  │  └──────────────┘ │ │ │   │
│  │  │  │ - Токены   │  │  │  │  ┌──────────────┐ │ │ │   │
│  │  │  │ - Компон.  │  │  │  │  │ComponentsPage│ │ │ │   │
│  │  │  └────────────┘  │  │  │  └──────────────┘ │ │ │   │
│  │  │  ┌────────────┐  │  │  └────────────────────┘ │ │   │
│  │  │  │ Переключ.  │  │  │  FadeTransition         │ │   │
│  │  │  │   темы     │  │  │                         │ │   │
│  │  │  └────────────┘  │  │                         │ │   │
│  │  └──────────────────┘  └──────────────────────────┘ │   │
│  └──────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                            │
            ┌───────────────┴───────────────┐
            ▼                               ▼
┌──────────────────────────┐  ┌──────────────────────────────┐
│   tokens_page.dart       │  │  components_page.dart        │
│  ┌────────────────────┐  │  │  ┌──────────┐  ┌──────────┐ │
│  │  Заголовок         │  │  │  │ Настройки│  │Предпросм.│ │
│  └────────────────────┘  │  │  │          │  │          │ │
│  ┌────────────────────┐  │  │  │ - Text   │  │  ┌──────┐ │ │
│  │  Палитра           │  │  │  │ - Icons  │  │  │Phone │ │ │
│  │  ┌──────────────┐  │  │  │  │ - State  │  │  │Frame │ │ │
│  │  │Black Colors  │◄─┼──┼──┼──┤ - Style  │  │  │      │ │ │
│  │  │White Colors  │  │  │  │  │ - Type   │  │  │UiBtn │ │ │
│  │  │Blue Colors   │  │  │  │  │ - Size   │  │  └──────┘ │ │
│  │  │...           │  │  │  │  │ - Role   │  │          │ │
│  │  └──────────────┘  │  │  └──────────┘  └──────────┘ │ │
│  └────────────────────┘  │                              │ │
│  ┌────────────────────┐  │                              │ │
│  │  Отступы           │  │                              │ │
│  └────────────────────┘  │                              │ │
│  ┌────────────────────┐  │                              │ │
│  │  Шрифты            │  │                              │ │
│  └────────────────────┘  │                              │ │
│  ┌────────────────────┐  │                              │ │
│  │  Токены            │  │                              │ │
│  └────────────────────┘  │                              │ │
└──────────────────────────┘  └──────────────────────────────┘
            │                               │
            └───────────────┬───────────────┘
                            ▼
┌─────────────────────────────────────────────────────────────┐
│              core/theme/ (Система тем)                       │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  app_theme.dart                                       │   │
│  │  AppThemeProvider                                     │   │
│  └──────────────────────────────────────────────────────┘   │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  app_theme_tokens.dart                               │   │
│  │  AppThemeLightTokens / AppThemeDarkTokens           │   │
│  └──────────────────────────────────────────────────────┘   │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  app_colors.dart                                     │   │
│  │  AppColors (White, Black, Blue, Red, Orange, Green) │   │
│  └──────────────────────────────────────────────────────┘   │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  app_spacing.dart                                    │   │
│  │  AppSpacing (spacing0-spacing32, spaceX1-spaceX6)   │   │
│  └──────────────────────────────────────────────────────┘   │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  app_typography.dart                                 │   │
│  │  AppTypography (fontSans, weights, sizes)            │   │
│  └──────────────────────────────────────────────────────┘   │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  app_text_styles_web.dart                            │   │
│  │  AppTextStylesWeb (H1, H2, Body, Small)             │   │
│  └──────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│              ui/widgets/ (Компоненты)                        │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  ui_button.dart                                       │   │
│  │  UiButton - универсальный компонент кнопки           │   │
│  └──────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

## Ключевые особенности архитектуры

### 1. Управление состоянием
- `AppThemeProvider` использует `ChangeNotifier` для реактивного обновления UI
- `ListenableBuilder` в `main_web.dart` слушает изменения темы
- Локальное состояние в StatefulWidget для навигации и анимаций

### 2. Анимации
- `FadeTransition` для переключения страниц
- `AnimatedSize` для сворачивания/разворачивания групп
- `AnimatedRotation` для иконок стрелок
- Hover-эффекты с анимацией масштабирования

### 3. Адаптивность тем
- Все цвета берутся из дизайн-токенов
- Автоматическое переключение между светлой и темной темой
- Использование `surfaceNeutralHigh` для белых карточек в темной теме
- Черный текст на белом фоне в темной теме для читаемости

### 4. Модульность
- Разделение на страницы (tokens_page, components_page)
- Отдельная система тем (core/theme/)
- Переиспользуемые компоненты (ui/widgets/)
- Веб-специфичные стили (app_text_styles_web.dart)

### 5. Интерактивность
- Сворачиваемые/разворачиваемые группы токенов
- Интерактивная настройка компонентов в реальном времени
- Hover-эффекты на всех интерактивных элементах

## Цветовая схема
- **Основной цвет**: #454DE7 (фиолетовый)
- **Градиенты**: #454DE7 → #6B73FF
- **Светлая тема**: Белый фон, черный текст
- **Темная тема**: Темный фон, белый текст, белые карточки с черным текстом

## Типографика
- **Шрифт**: Roboto (Google Fonts для веба)
- **Заголовки**: H1 (36px), H2 (24px)
- **Основной текст**: Body (18px)
- **Мелкий текст**: Small (14px)

## Размеры и отступы
- Боковая панель: 280px
- Мобильный предпросмотр: 375x812px
- Отступы: 8px, 12px, 16px, 20px, 24px, 32px
- Скругления: 8px, 12px, 16px

